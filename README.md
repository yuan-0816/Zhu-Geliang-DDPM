### This repostory is inspired by / based on the following repositories:
   - [diffusion-DDIM-pytorch](https://github.com/Alokia/diffusion-DDIM-pytorch)
   - [yolov5-crowdhuman](https://github.com/deepakcrk/yolov5-crowdhuman)

---

## Zhu-Geliang face datasets   
I use [yolov5-crowdhuman](https://github.com/deepakcrk/yolov5-crowdhuman) to make the Zhu-Geliang datasets, and I use the opencv ```cv2.face.LBPHFaceRecognizer_create()``` to find the face of Zhu-Geliang.   
I upload the datasets to the Kaggle, you can download it from [here](https://www.kaggle.com/datasets/yuanyuan0816/zhugeliang-face)

put this all datasets to "Zhu-Geliang-DDPM" folder

```
git clone https://github.com/yuan-0816/Zhu-Geliang-DDPM.git
cd Zhu-Geliang-DDPM/yolov5_crowdhuman
```

We use this yolo repository to make the Zhu-Geliang datasets:
```
git clone https://github.com/deepakcrk/yolov5-crowdhuman.git/.
pip install -r requirements.txt
```

Download the pre-trained weights of YOLOv5:
https://github.com/deepakcrk/yolov5-crowdhuman   
put this pre-trained weights to "yolov5_crowdhuman" folder


```
 #######  ###                          ####             ###       ##
 #   ##    ##                         ##  ##             ##
    ##     ##      ##  ##            ##        ####      ##      ###      ####    #####     ### ##
   ##      #####   ##  ##            ##       ##  ##     ##       ##         ##   ##  ##   ##  ##
  ##       ##  ##  ##  ##            ##  ###  ######     ##       ##      #####   ##  ##   ##  ##
 ##    #   ##  ##  ##  ##             ##  ##  ##         ##       ##     ##  ##   ##  ##    #####
 #######  ###  ##   ######             #####   #####    ####     ####     #####   ##  ##       ##
                                                                                           #####
```


```
---------------------::::::::-----=+**############*****#####*****+++*##########*+==----------------::::::::::::::::::::::
------------------------------==+*#*####################%%%%#########%%%%%%%%%%%%###*+==---------------::::::::::::::::::
----------------------------=+*****##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+==-------------::::::::::::::::
-------------------------++*********####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+=----------:::::::::::::::::
----------------------=+************##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=-----------:::::::::::::
--------------------+***#*********###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++=-------------::::::::
------------------+*************####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%##*+=-----------::::::::
----------------+*********+***####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=---------::::::::
--------------+*********++***#####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=--------:::::::
------------+*********+++++**###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=------:::::::
----------=+*********+++=+**###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+===----::::::
---------+**++*+++++++=++*###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+==---::::::
-------=+*****++****++++*###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=-----:::
------=+**+++++*********##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+==---:::
-----=+**++++***###**####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#++=---::
----=+***++***#########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+=---:
--=++****+**##########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*+==--
-==+**###*###%%%%####%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+==-
-++*#######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#+==
+*###%%###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*=
*##%%%%#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#*
##%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%#######**###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%########%%%%%%%%%%%%####***************###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%#*++++*****************+++++++++++++++++*****#########%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%##**+++++++++++++++++++++++++++++++++++++++++++*********######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%##**+++=========++++++++++++++===+++++++++++++++++++++***********######%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%#*++++===============+++++=+++===+++++==+++++++++++++++++++++++++*******###%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%#*+=+=================+++====+++==+++++++++++++++++++++++********+++++*****###%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%#*++++++++=========+++++===++++++==+*++++++**********************************###%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%#*++++++++++++++++++++++++++++++++==+**++++*******###**************************###%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%#*+++++++++***************++++++++===++**+++*******###########******+************##%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%*+++++++++*****######*******+++++++==++**************###########*****+++++++++****##%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%#+++==++++******#####***********+++++++++******************************++++++++++**###%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%#*++===++++++++*******************++++++++*******************++++*******++++++++++***##%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%#++===++++++++++++**************++++++++++***********************++++++++++++++++++***#%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%#*+===========++++***************++++++=+++****************####*****+++++++++++++++++***#%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%#*++=========++***###%%####*******+++++==++****************##%%%###*****++++++++++++++***##%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%#*+++=======++**#***##%%%####******+++++==++**********###***##%%##**##*****++++++++++++****#%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%#*++=======++****++**##%####******++++++==+++***************############****+++++++++++****##%%%%%%%%%%%%%%%%%%%%%
%%%%%%%#*++=======+++++******************++++++==++++********************************+++++++++*****#%%%%%%%%%%%%%%%%%%%%%
%%%%%%%#++==========++++++++************+++++=====++++*****+**************+++++++++++++++++++++*****#%%%%%%%%%%%%%%%%%%%%
%%%%%%%*++===========+++++++++++*+++*++++++=======+++++++++++++***++++++++++++++++++++++++++++++****#%%%%%%%%%%%%%%%%%%%%
%%%%%%#*+============++++++++++++++++++++=========++++++++++++++++++++++++++++++++++++++++++++++++***#%%%%%%%%%%%%%%%%%%%
%%%%%%#*+=============+++++++++++++++=============+++++++++++++++++++++++++++++++++++++++++++++++++**#%%%%%%%%%%%%%%%%%%%
%%%%%%*+=============+++++++++++++=================++++++++++++++++++++++++++++++++++++++++++++++++**#%%%%%%%%%%%%%%%%%%%
%%%%%%*+===============+++++++++====================++++++++++++++++++++++++++++++++++++++++++++++++*#%%%%%%%%%%%%%%%%%%%
%%%%%%*+=============================================+++++++++++++++++++++++++++++++++++++++++++++++*#%%%%%%%%%%%%%%%%%%%
%%%%%%*+=============================================+++++++++++++++++++++++++++++++++++++++++++++++*#%%%%%%%%%%%%%%%%%%%
%%%%%%*+==========================+++==============+++++++++++*+++++++++++++++++++++++++++++++++++++*#%%%%%%%%%%%%%%%%%%%
%%%%%%#+=========================++++============+++++++++++++***++++++++++++++++++++++++++===++++++*#%%%%%%%%%%%%%%%%%%%
%%%%%%%*+=====================++++++=======+++++++++++++++++++****+++++++++++++++++++++++======+++++*##%%%%%%%%%%%%%%%%%%
%%%%%%%*+===================++++++*+===++++++++++++++****++++++***+++++++++++++++++++++++======+++++*##%%%%%%%%%%%%%%%%%%
%%%%%%%#+==================++++++*+==++*##*+++++++++*#%%#*+++++****++++++++++++++++++++++++=====++++**#%%%%%%%%%%%%%%%%%%
%%%%%%%%*+================+++++++*++++*#%%%#*+++++**##%%%#*++++*****++++++++++++++++++++++++====++++**##%%%%%%%%%%%%%%%%%
%%%%%%%%#+===============+++++++**++++*##%%%#**+++***#%%#***+********+++++++++++++++++++++++====++++***###%%%%%%%%%%%%%%%
%%%%%%%%#+===============++++++**++++++***************#*******++******+++++++++++++++++++++++===+++++*****##%%%%%%%%%%%%%
%%%%%%%%%*================+++++*+++===+++++++*****************+++******++++++++++++++++++++++===++++++******#%%%%%%%%%%%%
%%%%%%%%%*================++++**++=====+++++++****************++++******++++++++++++++++++++++++++++++++*****##%%%%%%%%%%
%%%%%%%%%*================++++*+=======+++++++***++**********++++++*****+++++++++++++++++++++++++++++++++++****%%%%%%%%%%
%%%%%%%%%*================+++*++========++++++***++++*****+++++++++++****+++++++++++++++++++++++++++++++++++++*#%%%%%%%%%
#%%%%%%%%*================+++++===========+++++++++++++++++++++++++++****++++++++++++++++++++++++++++++++++++++*%%%%@@%%%
*#%%%%%%#+================++++============+++++++++++++++++++++++++++++***+++++++++++++++++++++=+++++++++++++++*%%%%%%%%%
**#%%%%#*+================++++============++++++++++++++++++++++++++++++**++++++++++++++++++++++++++++++++++*##%%%%%%%%%%
++*##%#*+=+=-==============++===========++++++++++*********++++++++++++++**+++++++++++++++++++++++++++++++++*%@%%%%%%%%%%
===+*##*==+================++=========++***********************++++++++++**+++++++++++++++++++++++++++++++++#%@@%%%%%%%%%
---=+*%*+=++===============++=======++****************######*****++++*++++**++++++++++++++++++++++++++++++++#%%%%%%%%%#**
----=+**+=++===============++======+**###%%%%%########%%%%%######***********+++++++++++++++++++++++++++++++*#%%%%%%%#*=--
----==++***#*==============++====++*##%%%%###*****************######*********++++++++++++++++++++++++++++++*%%%%%#*++--::
--==+**###%%#+=============+++++++*#%%%%####******+++***+*****###%##*********++++++++++++++++++++++++++++++#%#*+==---::::
=+***#####%%%#=============+++++++**##*#########*********##########***********++++++++++++++++++++++++++++*##*+=--:::::::
++**######%%%%*============++++===++++++***#####################***************+++++++++++++++++++++++++++***+++=-:::::::
*******+*####%#+==---=====+++++=====+++++**************************************++++++++++++++++++++++++++****++===--:::::
=====++=+++++*##+=---=====+++++=====+++++***************************************+++++++++++++++++***+++++##*++======-::::
===========--=+#*+=--====++++++====++++++****************************************+++++++++++++++***++++++##*+========--::
=--------------=**==-====++++++===++++++************##***************************+++++++++++*++******++==*#*+=======----:
=---------------====-=====+++====+++++++++*****#############*************************+++++***********++==*#*=====--------
=--------------------===========++++++++++++********#########*********************+**++++***********+=-==***===----------
=---------------------==========++++++++++++++++*************************************+++***********+==-=+**+===----------
---------------------===========++++++++++++++++++***********************************************++=---=+**+==-----------
---------------------========+=====+++++++++++++***********************************************++=-----=+**+==-----------
---------------------==+++===+=======++++++++++***********************************************+=------=****+=------------
---------------------==++***+++======+++++++++***********************************************+=-------+****==------------
--------------------===++*##*+=======+++++++***********************************************+==------=+*++*+=-------------
--------------------===++**##*+=====++++++************************************************+==-----==**+***+=-------------
---------------------===++**#**+====+++++++**********************************************+==-----=+****+*+=--------------
----------------------==+++****+--===++++++********************************************+====----=****++**+=--------------
-----------------------==+++++-::--===+++++*******************************************+====---=+*********==--------------
------------------------==-:....::--==+++++*****************##**********************++=======+**********+=---------------
----------====----------::.....::::---=++++++******************************#*******+=========***********+=---------------
--------========---::......:::::::::---==+++++++***************************#*****+===========***********==---------------
-------=======--:.........:::::::::::----=++++++++*****************************++============**********+=----------------

```